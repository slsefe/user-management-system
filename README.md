# Getting Started

## 需求描述

- 用户可以注册账号
- 用户可以登录
- 管理员可以查询注册的用户信息

## 功能详细设计

### 用户注册

- 接口：POST /users/register
- 入参：账户、密码、
- 返回值：创建好的账号id，如果注册失败，抛出异常
- 逻辑
  - 入参校验
    - 账户：
      - 长度校验：不小于4位，不大于10位，
      - 正则校验：只能包含：大小写字母、数字、下划线、中划线，不能包含特殊字符
      - 业务逻辑校验：账户不能和已有的重复
    - 密码：
      - 长度校验：不小于8位，不大于30位
      - 正则校验：必须包含：大小写字母、数字、特殊字母
      - 两次输入的密码必须一致
      - 密码不能明文存储在数据库

### 用户登录

- 接口：POST /users/login
- 入参：用户账户、用户密码
- 返回值：用户信息（敏感信息需要脱敏）
- 逻辑
  - 参数校验：
  - 密码正确性校验
  - 记录用户的登录态（session），存到服务器上（用后端springboot框架封装的服务器tomcat去记录）
  - 返回用户信息（敏感信息脱敏）

### 获取当前用户

- 接口：GET /users/current
- 返回值：当前已登录用户
- 逻辑：
  - 从session获取当前用户凭据
  - 查询数据库，获取用户最新信息，并返回

### 注销/退出登录

- 接口：POST /api/users/logout
- 请求体：无
- 返回值：无
- 逻辑：
  - 从session中获取当前用户凭据，移除凭据

### 管理员查询用户列表

- 接口：GET /api/users
- 请求体：
- 返回值：用户列表
- 逻辑
  - 判断当前用户是否已经登录，如果没有登录跳转到登录页面
  - 判断当前用户是否是管理员，如果不是管理员返回空列表
  - 如果当前用户是管理员，根据查询条件查询用户数据表
- 分页（TODO）

### 管理员删除用户

- 接口：DELETE /ap/users/{userId}
- 请求体：无
- 返回值：是否成功删除
- 逻辑：
  - 判断当前用户是否已经登录，如果没有登录跳转到登录页面
  - 判断当前用户是否是管理员，尝试删除指定用户

# 技术点

## cookie和session

- 客户端在第一次请求服务端之后，服务端生成一个session，在响应体中返回给前端一个设置cookie的命令，并且返回sessionId；
- 前端根据请求的响应体，设置cookie，保存到浏览器中
- 前端再次请求服务端的时候，请求头带上cookie
- 后端根据请求头的cookie，识别到sessionId，根据sessionId获取存储的信息（用户登录状态）
